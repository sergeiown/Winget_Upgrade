# Winget Upgrade

[EN](https://github.com/sergeiown/Winget_Upgrade/blob/main/readme.md) | **[UA](https://github.com/sergeiown/Winget_Upgrade/blob/main/readme_ua.md)**

Winget Upgrader - це інструмент командного рядка Node.js, який автоматизує процес оновлення програмного забезпечення на комп'ютері за допомогою Windows Package Manager ([Winget](https://learn.microsoft.com/uk-ua/windows/package-manager/winget/)).

|  | Структура та зовнішній вигляд |
| --- | --- |
| Залежності | ![image](https://github.com/user-attachments/assets/7101a8c0-8c15-4f11-8515-90b155c6e1b0) |
| Зовнішній вигляд консолі | ![image](https://github.com/sergeiown/Winget_Upgrade/assets/112722061/3620b5fe-daf2-4a8d-8fc9-2fcaf673c25b) |

Winget Upgrader використовує команди Winget для оновлення всього програмного забезпечення, встановленого на вашому комп'ютері. Він автоматично перевіряє наявність Winget на вашій системі, виконує оновлення програм та веде журнал подій для зручності слідкування за процесом.

```
Windows Package Manager (Winget) - це інструмент управління пакетами для ОС Windows,
який дозволяє легко встановлювати, оновлювати та видаляти програмне забезпечення
безпосередньо з командного рядка. Winget дозволяє швидко та зручно оновлювати
встановлені програми, що робить його корисним інструментом для підтримки вашої
системи в актуальному стані.
```
## Функціонал

### Перевірка наявності Winget
Перш ніж почати оновлення, програма перевіряє наявність Winget у системі. Якщо Winget не встановлено, програма виводить помилку та припиняє роботу.

### Оновлення програм
Winget Upgrader використовує команду `winget upgrade --all`, щоб оновити всі встановлені програми. Він автоматично приймає умови угоди та виключає інтерактивність, щоб процес оновлення був безперервним.

### Ведення журналу
Програма веде журнал подій у файлі `winget_upgrade.log`, де зберігає інформацію про виконані дії, помилки та інші події, пов'язані з процесом оновлення.
Файл журналу `winget_upgrade.log` зберігається у теку `%USERPROFILE%\documents\`.

### Обмеження розміру журналу
Журнал автоматично обрізається, якщо його розмір перевищує 256 КБ, щоб уникнути переповнення файлу.

## Вимоги до системи

| Підтримується у версіях Windows з підтримкою winget (Windows Package Manager): Windows 10 версії 1809 (Build 17763) і новіших або Windows 11 |                       [![windows_compatibility](https://github.com/user-attachments/assets/db2b5487-b5bf-45d9-8948-48bb88162f17)](https://en.wikipedia.org/wiki/List_of_Microsoft_Windows_versions)                       |
| :--- | :---: |

## Використання

Використовуте winget_upgrade.exe доступний для завантаення в [релізі](https://github.com/sergeiown/Winget_Upgrade/releases), або скористайтеся альтернативним методом:

1. Запустіть програму за допомогою команди `node main.js`.
2. Програма автоматично перевірить наявність Winget у системі.
3. Якщо Winget присутній, вона почне оновлення всього програмного забезпечення.
4. Процес оновлення буде відображатися у вікні консолі, а також записуватися у файл журналу `%USERPROFILE%\documents\winget_upgrade.log`.
5. Після завершення оновлення програма автоматично вийде через 10 секунд, або ви можете вийти вручну, натиснувши будь-яку клавішу.

Додатково ви можете скористатися `start_menu_shortcut_enabler.bat`, який додасть ярлик `winget_upgrade.exe` до Windows Start Menu, що забезпечить автоматичний запуск Winget Upgrade разом із системою.

## Повідомлення про помилки

У разі виникнення помилок, програма виводить відповідні повідомлення у консоль та записує їх у файл журналу для подальшого аналізу.

## Завершення роботи

Після завершення оновлення програми автоматично виходить, щоб звільнити ресурси системи.

## Вкладені файли

- `main.js`: Головний файл програми.
- `utils.js`: Модуль для виконання команд та ведення журналу подій.
- `settings.js`: Модуль, який містить необхідні налаштування для виконання команд та ведення журналу подій.
- `start_menu_shortcut_enabler.bat`: batch скрипт, який додає ярлик `winget_upgrade.exe` до Windows Start Menu або прибирає його за необхідності.

## Ліцензія

[Copyright (c) 2024 Serhii I. Myshko](https://github.com/sergeiown/Winget_Upgrade/blob/main/LICENSE)
